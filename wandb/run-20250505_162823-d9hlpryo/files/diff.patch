diff --git a/lda.py b/lda.py
index 7ecc705..d7910c6 100644
--- a/lda.py
+++ b/lda.py
@@ -102,14 +102,14 @@ def lda(X, y, n_classes, lamb):
     #lamb = torch.trace(Sw) / D
     #Sw = graphical_lasso(Sw)
     
-    Sw = Sw + torch.eye(D, dtype=X.dtype, device=X.device, requires_grad=False) * lamb
+    #Sw = Sw + torch.eye(D, dtype=X.dtype, device=X.device, requires_grad=False) * lamb
     #Sw_np = Sw.cpu().detach().numpy()
     #lw = ledoit_wolf().fit(Sw_np)  # add a sample axis if needed
-    # shrinkage = 0.8
-    # mu = torch.trace(Sw) / D
+    shrinkage = 0.9
+    mu = torch.trace(Sw) / D
 
     # Apply shrinkage â€” differentiable
-    # Sw = (1 - shrinkage) * Sw + shrinkage * mu * torch.eye(D, dtype=X.dtype, device=X.device, requires_grad=False)
+    Sw = (1 - shrinkage) * Sw + shrinkage * mu * torch.eye(D, dtype=X.dtype, device=X.device, requires_grad=False)
     #Sw =  Sw +  mu * torch.eye(Sw.shape[0], device=Sw.device, dtype=Sw.dtype)
     #Sw =  mu * torch.eye(Sw.shape[0], device=Sw.device, dtype=Sw.dtype)
     # diag_values = torch.rand(D, device="cuda") * 0.0001  # Uniform[0, lam)
diff --git a/train.py b/train.py
index 86bebf7..5c41c6f 100644
--- a/train.py
+++ b/train.py
@@ -528,8 +528,8 @@ if __name__ == '__main__':
         'n_eig': 4,
         'margin': None,
         'epochs': 50,
-        'k_classes': 10,
-        'n_samples': 512,
+        'k_classes': 5,
+        'n_samples': 128,
         # Memory optimization parameters
         'gradient_accumulation_steps': 1,  # Accumulate gradients to save memory
         'use_amp': True,                   # Use automatic mixed precision
diff --git a/wandb/latest-run b/wandb/latest-run
index 5701d1c..ad78d7c 120000
--- a/wandb/latest-run
+++ b/wandb/latest-run
@@ -1 +1 @@
-run-20250505_154131-q14pc3hm
\ No newline at end of file
+run-20250505_162823-d9hlpryo
\ No newline at end of file
diff --git a/wandb/run-20250505_154131-q14pc3hm/run-q14pc3hm.wandb b/wandb/run-20250505_154131-q14pc3hm/run-q14pc3hm.wandb
index ca9d42a..7420a39 100644
Binary files a/wandb/run-20250505_154131-q14pc3hm/run-q14pc3hm.wandb and b/wandb/run-20250505_154131-q14pc3hm/run-q14pc3hm.wandb differ
